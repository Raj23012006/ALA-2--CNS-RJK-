<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CNS Malware Lab — Simulation Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-main: #0c1021;
            --bg-panel: #151a2b;
            --accent: #0ef6cc;
            --accent2: #ffb347;
            --accent3: #f93cff;
            --text: #e7f2ff;
            --muted: #9fb0c9;
            --border: rgba(255,255,255,0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: radial-gradient(circle at top left, #10142b, #050812);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        .siteContainer {
            display: flex;
            flex-direction: column;
            width: 100%;
            min-height: 100vh;
            padding: 0 2rem;
        }

        /* HEADER */
        .topBar {
            background: linear-gradient(90deg, #141933 0%, #0d1127 100%);
            padding: 1.2rem 2rem;
            border-radius: 0 0 16px 16px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 1.2rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }

        .leftHeader h1 {
            font-size: 1.5rem;
            color: var(--accent);
        }

        .sub {
            font-size: 0.9rem;
            color: var(--muted);
            margin-top: 4px;
        }

        .btn {
            background: var(--accent);
            color: #000;
            font-weight: 600;
            border: none;
            padding: 0.5rem 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 0 10px var(--accent);
        }

        .btn.ghost {
            background: transparent;
            color: var(--accent);
            border: 1px solid var(--accent);
        }

        .btn.ghost:hover {
            background: var(--accent);
            color: #000;
        }

        /* MAIN LAYOUT */
        .layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin: 2rem auto;
            width: 100%;
            max-width: 1300px;
        }

        .visualArea {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1rem;
            position: relative;
            box-shadow: 0 0 18px rgba(0,255,255,0.08);
        }

        svg {
            width: 100%;
            height: 100%;
        }

        .sidebar {
            background: var(--bg-panel);
            border-radius: 16px;
            border: 1px solid var(--border);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
            box-shadow: 0 0 18px rgba(255,255,255,0.05);
        }

        .panelHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .muted {
            color: var(--muted);
        }

        .smallMuted {
            color: var(--muted);
            font-size: 0.85rem;
        }

        .infoBox {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px;
        }

        .controlsGrid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        input[type="range"] {
            width: 100%;
            accent-color: var(--accent);
        }

        .actionRow button {
            flex: 1;
        }

        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }

        .statusDot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .statRow {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dashed var(--border);
            padding: 4px 0;
        }

        .statNum {
            font-weight: bold;
            color: var(--accent2);
        }

        .pageFooter {
            text-align: center;
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: auto;
            padding: 1.5rem 0;
            border-top: 1px solid var(--border);
        }

        @media (max-width: 950px) {
            .layout {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="siteContainer">
        <header class="topBar">
            <div class="leftHeader">
                <h1>Malware Simulation — Choose a Scenario</h1>
                <div class="sub">Worm • Trojan Horse • Virus — interactive demonstration for learning</div>
            </div>

            <div class="topControls">
                <div class="modes" style="display:flex;gap:8px;align-items:center">
                    <button class="btn modeBtn" id="modeWorms">Worms</button>
                    <button class="btn modeBtn" id="modeTrojan">Trojan</button>
                    <button class="btn modeBtn" id="modeVirus">Virus</button>
                </div>

                <div class="runControls" style="display:flex;align-items:center;gap:8px;margin-top:10px">
                    <button class="btn" id="startBtn">Run</button>
                    <button class="btn ghost" id="pauseBtn">Pause</button>
                    <button class="btn ghost" id="resetBtn">Clear</button>
                </div>
            </div>
        </header>

        <main class="layout">
            <section class="visualArea" id="canvasWrap">
                <svg id="netSvg" viewBox="0 0 900 540" preserveAspectRatio="xMidYMid meet"></svg>
                <div id="tooltip" class="tooltip"></div>
            </section>

            <aside class="sidebar">
                <article class="panel">
                    <div class="panelHeader">
                        <div class="muted">Scenario details</div>
                        <div class="muted">Active: <strong id="currentMode">Worms</strong></div>
                    </div>

                    <div id="modeInfo" class="infoBox" style="margin-top:8px">
                        <div style="font-weight:700;margin-bottom:6px;color:var(--accent2)">Worms — spreading autonomously</div>
                        <div class="muted small">
                            Worms automatically scan connected hosts and attempt to spread along network links.
                            Change infection and remediation settings to see different propagation patterns.
                        </div>
                    </div>

                    <div style="margin-top:12px">
                        <div class="muted small">Simulation settings</div>
                        <div class="infoBox" style="padding:10px;margin-top:8px">
                            <div class="controlsGrid">
                                <div class="rangeRow">
                                    <div class="smallMuted">Worm infection probability <span id="wormRateLabel">0.50</span></div>
                                    <input id="wormRate" type="range" min="0" max="1" step="0.01" value="0.5">
                                </div>

                                <div class="rangeRow">
                                    <div class="smallMuted">Trojan click success <span id="trojanRateLabel">0.40</span></div>
                                    <input id="trojanRate" type="range" min="0" max="1" step="0.01" value="0.4">
                                </div>

                                <div class="rangeRow">
                                    <div class="smallMuted">Patch probability per tick <span id="patchRateLabel">0.15</span></div>
                                    <input id="patchRate" type="range" min="0" max="0.5" step="0.01" value="0.15">
                                </div>

                                <div class="rangeRow">
                                    <div class="smallMuted">Tick interval (ms) <span id="speedLabel">600</span></div>
                                    <input id="speedRange" type="range" min="120" max="1500" step="30" value="600">
                                </div>
                            </div>

                            <div class="actionRow" style="display:flex;gap:8px;margin-top:10px">
                                <button id="spawnTrojan" class="btn" style="flex:1">Spawn Trojan</button>
                                <button id="seedInfected" class="btn ghost" style="flex:1">Seed Initial</button>
                            </div>

                            <div style="display:flex;gap:8px;margin-top:10px;align-items:flex-start">
                                <div style="flex:1">
                                    <div class="smallMuted">Nodes in network</div>
                                    <input id="netSize" type="range" min="6" max="80" step="1" value="20">
                                </div>

                                <div style="width:110px">
                                    <div class="smallMuted">Auto-seed</div>
                                    <div style="display:flex;gap:8px;align-items:center">
                                        <div class="switch">
                                            <div id="autoSeedToggle" class="toggle on">
                                                <div class="knob"></div>
                                            </div>
                                        </div>
                                        <div class="smallMuted" id="autoSeedCount">1</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="legend" style="margin-top:12px">
                            <div class="badge"><span class="statusDot" style="background:#10b981"></span> Healthy</div>
                            <div class="badge"><span class="statusDot" style="background:#ef4444"></span> Infected</div>
                            <div class="badge"><span class="statusDot" style="background:#f59e0b"></span> Compromised</div>
                            <div class="badge"><span class="statusDot" style="background:#60a5fa"></span> Patched</div>
                        </div>

                        <p class="note" style="margin-top:8px">
                            Click nodes to simulate user interaction. Trojan files appear as small yellow squares — clicking them
                            imitates a social-engineering vector that may compromise the host.
                        </p>
                    </div>

                    <div style="margin-top:10px">
                        <div class="muted small">Live counters</div>
                        <div class="infoBox" id="statsBox" style="margin-top:6px">
                            <div class="statRow"><div>Healthy</div><div class="statNum" id="statHealthy">0</div></div>
                            <div class="statRow"><div>Infected</div><div class="statNum" id="statInfected">0</div></div>
                            <div class="statRow"><div>Compromised</div><div class="statNum" id="statCompromised">0</div></div>
                            <div class="statRow"><div>Patched</div><div class="statNum" id="statPatched">0</div></div>

                            <div class="smallMuted" style="margin-top:8px">Ticks: <span id="tickCount">0</span></div>
                            <div class="chart" id="chart" style="margin-top:8px"></div>
                        </div>
                    </div>

                    <div class="panelNote" style="margin-top:12px">
                        Run locally: <code>pip install flask</code> · <code>python app.py</code> · open <code>http://127.0.0.1:5000</code>
                    </div>
                </article>
            </aside>
        </main>

        <footer class="pageFooter">
            Educational use only — modelled behaviors are simplified (scanning cadence, privilege steps, and exploit details are abstracted).
        </footer>
    </div>

    <script src="script.js" defer></script>
</body>
</html>
